<html>

<head>
  <title>BIOS Server</title>
  <link href="style.css" type="text/css" rel="stylesheet">
  <base target="_self">
</head>

<body>

<!-- Right table starts -->
<table class="right" cellspacing="0">
  <tr>
    <td class="left"><img src="images/left_round.gif" width="10" height="15"></td>
    <td class="mini">
      <a href="../../index.html" target="_top">Release Doc</a> &gt;
      <a href="index.html" target="_top">Examples</a> &gt;
      <a href="menu/menu_examples_compound.html" target="menu">Compound Examples</a> &gt;
      <a href="bios_server.html">BIOS Server</a>
    </td>
    <td class="right"><img src="images/right_round.gif" width="10" height="15"></td>
  </tr>
  <tr><td colspan="3"><img src="images/trans_high.gif" width="1" height="10"></td></tr>
  <tr><td colspan="3"><img src="images/top_wide.gif" width="620" height="5"></td></tr>
  <tr><td class="title" colspan="3">BIOS Server</td></tr>
  <tr><td colspan="3"><img src="images/bottom_wide.gif" width="620" height="15"></td></tr>
  <tr><td colspan="3"><img src="images/top_wide.gif" width="620" height="5"></td></tr>
  <tr><td class="content" colspan="3">
  
<!-- Content cell ends -->
    <a href="../Delphi/Compound/Bios/Server.dpr">Launch Delphi-example</a>
    <p>This example of how to use the COM based components in $(PRODUCT_BASE_NAME) is based on the
    classic example of Buildings and owners. Some parts have been reused completely unmodified, some
    parts ported using the Clientifier tool, and some parts are new for the example.
    </p>
    <p class="note"><b>NOTE!</b> To run this example, you must register two DLLs that ship with
    $(PRODUCT_BASE_NAME) (BoldComObjectSpace.dll and BoldComConnection.dll). They contain the
    typelibraries to use the com-support in $(PRODUCT_BASE_NAME). You must also register the TLB-file
    that is in the bios/core catalog (BuildingsAndOwners.tlb)
    </p>
    <hr size="1">
    <p class="head2">How to register the dll's</p>
    <p>To do the registration, use the following:</p>
    <ul>
      <li>regsvr32.exe<br>
        "c:\program files\BoldSoft\&lt;installation dir&gt;\bin\BoldComObjectSpace.dll"
      <li>regsvr32.exe<br>
        &quot;c:\program files\BoldSoft\&lt;installationdir&gt;\bin\BoldComConnection.dll&quot;
      <li> BuildingsAndOwners.tlb<br>
        &quot;c:\program files\Borland\DelphiX\bin\tregsvt.exe&quot;
    </ul>
<p class="head2">Modifications of the original example</p>
<p>The server uses the same datamodule as the original example (the BuildingsAndOwners
example) except that some renderers have been
    moved to a separate datamodule, and it has been renamed to <i>DMCore.pas</i>.&nbsp;<p>The
model has been renamed to BuildingsAndOwners (to avoid name collisions with other models being called
    BusinessClasses). It is generally a good idea to rename your model.
<p>GUIDs has been allocated to each class, and to the model (using a plugin in the ModelEditor).
    <p class="head2">The COM part</p>
    <p>In addition to the original generated code we have generated a set of COM interfaces:
    <ul>
      <li>core\BuildingsandOwners.idl&nbsp; - an IDL describing the interfaces</li>
      <li>core\BuildingsandOwners.tlb - binary version of the IDL, the type library</li>
      <li>core\BuildingsandOwners_TLB.pas - object pascal version of the tlb</li>
      <li>core\BuildingAndOwners_Adapters.pas - object pascal classes implementing the interfaces above
        (acting as adapters to the original classes in BuildingsAndOwners.pas)</li>
    </ul>
    <p>The server is exposed to the outer world through the datamodule <i>Server\DMServer.pas</i>. Here we find
    two important components:
<ul>
  <li>BoldComServerHandle1 - This component acts as the gateway for all incoming and out going
    communication to the server.</li>
  <li>
    BoldComServerElementHandle1 - This component exposes the SystemHandle of the core datamodule to the
    outside world.<br>
    &nbsp;&nbsp;&nbsp;BoldHandle = DMCore.SystemHandle - The exposed handle<br>
    &nbsp;&nbsp;&nbsp;ObjectName = System - The name of the exposed handle to the out side world<br>
    &nbsp;&nbsp;&nbsp;ServerHandle = BoldComServerHandle1 - The gateway to be exposed through</li>
</ul>
    <p>The Server Datamodule links the resource <i> ..\Core\BuildingAndOwners.tlb</i> so that we will be sure it
    is included in the compiled exe. This is optional and could be loaded/registered manually.
    <p>The unit ServerCode.pas was auto generated by right clicking the BoldComServerHandle1 and selecting
    &quot;Generate server code&quot; it contains the code to register the server as a COM server
    <p>The FServerConsole unit is not needed for the server to work. It is only included to that we can
    inspect what is happening to the objects in the server.
    <p>Thats all there is to it...<font face="Courier New">
<!-- Content cell ends -->
  
    </font>
  
  </td></tr>
  <tr><td colspan="3"><img src="images/bottom_wide.gif" width="620" height="15"></td></tr>
  <tr>
    <td class="left"><img src="images/left_round.gif" width="10" height="15"></td>
    <td class="mini">All material $(COPYRIGHT_TEXT). Registered Trademarks and other trademarks
      are properties of their respective holders.</td>
    <td class="right"><img src="images/right_round.gif" width="10" height="15"></td>
  </tr>
</table>
<!-- Right table ends -->

</body>
</html>
