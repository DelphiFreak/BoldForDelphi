<html>

<head>
  <title>BIOS2 Server</title>
  <link href="style.css" type="text/css" rel="stylesheet">
  <base target="_self">
</head>

<body>

<!-- Right table starts -->
<table class="right" cellspacing="0">
  <tr>
    <td class="left"><img src="images/left_round.gif" width="10" height="15"></td>
    <td class="mini">
      <a href="../../index.html" target="_top">Release Doc</a> &gt;
      <a href="index.html" target="_top">Examples</a> &gt;
      <a href="menu/menu_examples_compound.html" target="menu">Compound Examples</a> &gt;
      <a href="bios2_server.html">BIOS2 Server</a>
    </td>
    <td class="right"><img src="images/right_round.gif" width="10" height="15"></td>
  </tr>
  <tr><td colspan="3"><img src="images/trans_high.gif" width="1" height="10"></td></tr>
  <tr><td colspan="3"><img src="images/top_wide.gif" width="620" height="5"></td></tr>
  <tr><td class="title" colspan="3">BIOS2 Server</td></tr>
  <tr><td colspan="3"><img src="images/bottom_wide.gif" width="620" height="15"></td></tr>
  <tr><td colspan="3"><img src="images/top_wide.gif" width="620" height="5"></td></tr>
  <tr><td class="content" colspan="3">
  
<!-- Content cell starts -->
    <a href="../Delphi/Compound/Bios2/Server/Server.dpr">Launch Delphi-example</a>
    <p>This second bios example shows how to use the BoldComServerObjectHandle and
    BoldComClientObjectHandle components to implement service objects.
    <p class="note"><b>NOTE!</b> To run this example, you must register the type library AccountServer.tlb located in the
    bios2\Server catalog.
    </p>
    <hr size="1">   
	<p class="head2">Register the type library</p>  
    <p>This is how you register the type library:<br>
    c:\program files\Borland\DelphiX\bin\tregsvr.exe&quot; AccountServer.tlb
<p class="head2">Interface and adapter classes
    <p>The server uses a very simplified version of the Banking model (Simple\ObjectSpace\Transaction).
    In addition to the original generated code for the business objects, we've also generated the business
    interfaces and adapter classes, they are found in the following units:
    <ul>
      <li>bios2\Server\BusinessClasses.idl<br>
        IDL code describing the interfaces</li>
      <li>bios2\Server\AccountServer.tlb<br>
        binary version of the IDL, the type library, this file is
        manually created.</li>
      <li>bios2\Server\BusinessClasses_TLB.pas<br>
        delphi code describing the typelib, generated by Delphi's
        type library editor.</li>
      <li>bios2\Server\BusinessClasses_Adapters.pas<br>
        the adapter classes implementing for the business objects.</li>
    </ul>
    <p>We have added (manually) a new custom interface to the typelib AccountServer.tlb:
    IAccountValidator. IAccountValidator is a custom interface we define for describing an account
    validator service. It has only one method, Validate, which takes an account number as parameter
    (Number) and returns a boolean value as an out parameter (Valid).
    <p>We also declare a new class TAccountValidator (in unit Server\dmProduct.pas) implementing the
    IAccountValidator interface. TAccountValidator is a COM object, deriving from the Delphi base class
    TComObject. Notice how the ValidateAccount method is implemented: it traverses a list of Account objects
    searching for the account number passed to it. The value of the out parameter Valid is set to True if
    a match is found and False otherwise.
<p class="head2">Server components
    <p>The server is exposed to the outer world through the datamodule Server\dmProduct.pas.
    <p>The following server handles are found in dmProduct:<br>&nbsp;
    <table width="600" cellspacing="0">
      <tr>
        <td class="grey" width="250">Component/Property or Event</td>
        <td class="grey" width="350">Description</td>
      </tr>
      <tr class="even">
        <td class="small"><b>BoldComServerElementHandle1</b></td>
        <td class="small">Exports the BoldSystem.</td>
      </tr>
      <tr class="odd">
        <td class="small">ObjectName ( = ' System')&nbsp;</td>
        <td class="small">Specifies the name under which the system is exported</td>
      </tr>
      <tr class="even">
        <td class="small">ServerHandle ( = BoldComServerHandle1)</td>
        <td class="small">Specifies the gateway through which the system is exported</td>
      </tr>
      <tr class="odd">
        <td class="small"><b>BoldComServerObjectHandle1</b></td>
        <td class="small">Exports our service object TAccountValidator</td>
      </tr>
      <tr class="even">
        <td class="small">ObjectName ( = ' AccountValidator')</td>
        <td class="small">Specifies the name under which TAccountValidator is exported</td>
      </tr>
      <tr class="odd">
        <td class="small">OnGetCOMObject</td>
        <td class="small">The OnGetComObject event handler should return the IUnknown interface of the exported COM
          object, i.e. TAccountValidator</td>
      </tr>
    </table>
    <p>The unit ServerCode.pas was auto generated by right clicking the BoldComServerHandle1
    and selecting &quot;Generate server code&quot;, it contains code for registering the
    server's connection factories.
    <p>The unit FServerConsole is not needed for the server to work. It enables us to inspect the objects
    in the BoldSystem and add/delete objects if necessary.
<!-- Content cell ends -->

  </td></tr>
  <tr><td colspan="3"><img src="images/bottom_wide.gif" width="620" height="15"></td></tr>
  <tr>
    <td class="left"><img src="images/left_round.gif" width="10" height="15"></td>
    <td class="mini">All material $(COPYRIGHT_TEXT). Registered Trademarks and other trademarks
      are properties of their respective holders.</td>
    <td class="right"><img src="images/right_round.gif" width="10" height="15"></td>
  </tr>
</table>
<!-- Right table ends -->

</body>
</html>
